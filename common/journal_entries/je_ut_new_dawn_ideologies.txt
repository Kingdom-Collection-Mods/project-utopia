ut_je_communist_propaganda_source = {
	icon = "gfx/interface/icons/event_icons/event_industry.dds"

	group = je_group_utopia

	on_monthly_pulse = {
		effect = {
			change_variable = {
				name = ut_communist_propaganda_var
				add = 1
			}
		}
		#todo events
	}

	complete = {
		scope:journal_entry = { is_goal_complete = yes }
	}

	on_complete = {
		# remove_modifier = ut_research_institute_found_mod
		# trigger_event = { id = utopia_journal_prod.40 } # site found
		# set_variable = ut_research_institute_found

		
		scope:target = {
			add_modifier = {
				name = ut_communist_propaganda_mod
			}
			je:je_ut_new_dawn = {
				add_progress = {
					value = 60
					name = ut_new_dawn_communist_bar
				}
			}
		}
	}

	invalid = {
		OR = {
			NOT = {
				any_scope_state = {
					is_split_state = no
					is_incorporated = yes
					ut_research_institute_site_building_trigger = yes
				}
			}
			#so it finishes when cheating
			has_variable = ut_research_institute_found_done
		}		
	}

	on_invalid = {
		remove_modifier = ut_research_institute_found_mod
		remove_variable = ut_communist_propaganda_var
	}

	current_value = {
		value = root.var:ut_communist_propaganda_var
	}

	goal_add_value = {
		value = 12 # 1 year
	}

	progressbar = yes

	weight = 10

	should_be_pinned_by_default = yes
}

ut_je_communist_propaganda_target = {
	icon = "gfx/interface/icons/event_icons/event_industry.dds"

	group = je_group_utopia

	on_monthly_pulse = {
		effect = {
			set_variable = {
				name = ut_communist_propaganda_var
				value = scope:target.var:ut_communist_propaganda_var
			}
		}
		#todo events
	}

	complete = {
		scope:target = {
			NOT = { has_modifier = ut_communist_propaganda_failed_mod }
			NOT = { has_journal_entry = ut_je_communist_propaganda_source }
		}
	}

	on_complete = {
		show_as_tooltip = {
			add_modifier = {
				name = ut_communist_propaganda_mod
			}
			je:je_ut_new_dawn = {
				add_progress = {
					value = 60
					name = ut_new_dawn_communist_bar
				}
			}
		}

		# remove_modifier = ut_research_institute_found_mod
		# trigger_event = { id = utopia_journal_prod.40 } # site found
		# set_variable = ut_research_institute_found
	}

	invalid = {
		scope:target = {
			has_modifier = ut_communist_propaganda_failed_mod
			NOT = { has_journal_entry = ut_je_communist_propaganda_source }
		}
	}

	on_invalid = {
	}

	current_value = {
		value = root.var:ut_communist_propaganda_var
	}

	goal_add_value = {
		value = 12 # 1 year
	}

	progressbar = yes

	weight = 10

	should_be_pinned_by_default = yes
}