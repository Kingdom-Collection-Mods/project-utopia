ut_je_propaganda_source = {
	icon = "gfx/interface/icons/event_icons/event_industry.dds"

	group = je_group_utopia

	immediate = {
		set_variable = {
			name = ut_propaganda_source_var
			value = 0
		}
	}

	modifiers_while_active = {
		ut_je_propaganda_source_mod
	}

	scripted_button = ut_new_dawn_propaganda_source_abort

	on_monthly_pulse = {
		effect = {
			change_variable = {
				name = ut_propaganda_source_var
				add = 1
			}
		}
	}

	complete = {
		scope:journal_entry = { is_goal_complete = yes }
	}

	on_complete = {	
		show_as_tooltip = {
			remove_modifier = ut_je_propaganda_source_mod
		}
		if = {
			limit = {
				has_modifier = ut_new_dawn_core_communist_mod
			}
			scope:target = {
				add_modifier = {
					name = ut_propaganda_communist_mod
					days = normal_modifier_time
					is_decaying = yes
				}
				custom_tooltip = ut_add_new_dawn_progress_neg_5
				ut_add_new_dawn_core_progress = {
					VALUE = -5
				}
			}
		}
		else_if = {
			limit = {
				has_modifier = ut_new_dawn_core_democratic_mod
			}
			scope:target = {
				add_modifier = {
					name = ut_propaganda_democratic_mod
					days = normal_modifier_time
					is_decaying = yes
				}
			}
		}
		else_if = {
			limit = {
				has_modifier = ut_new_dawn_core_fascist_mod
			}
			scope:target = {
				add_modifier = {
					name = ut_propaganda_fascist_mod
					days = normal_modifier_time
					is_decaying = yes
				}
			}
		}
		else_if = {
			limit = {
				has_modifier = ut_new_dawn_core_autocratic_mod
			}
			scope:target = {
				add_modifier = {
					name = ut_propaganda_autocratic_mod
					days = normal_modifier_time
					is_decaying = yes
				}
			}
		}
	}

	fail = {
		custom_tooltip = {
			text = ut_je_propaganda_source_abort_tt
			OR = {
				has_variable = ut_propaganda_source_abandon_var
				NOT = { exists = scope:target }
			}
		}
	}

	on_fail = {
		remove_variable = ut_propaganda_source_abandon_var
		remove_variable = ut_propaganda_source_var
		scope:target = {
			set_variable = ut_propaganda_target_abandon_var
		}
	}

	current_value = {
		value = root.var:ut_propaganda_source_var
	}

	goal_add_value = {
		value = 12 # 1 year
	}

	progressbar = yes

	weight = 10

	should_be_pinned_by_default = yes
}

ut_je_propaganda_target = {
	icon = "gfx/interface/icons/event_icons/event_industry.dds"

	group = je_group_utopia

	scripted_button = ut_new_dawn_propaganda_target_defend

	on_monthly_pulse = {
		effect = {
			if = {
				limit = { 
					has_variable = ut_new_dawn_propaganda_target_defend_cooldown_var
				}
				remove_variable = ut_new_dawn_propaganda_target_defend_cooldown_var
			}
		}
	}

	complete = {
		custom_tooltip = {
			text = ut_je_propaganda_target_abort_tt
			OR = {
				NOT = { exists = scope:target }
				has_variable = ut_propaganda_target_abandon_var
			}
		}
	}

	on_complete = {
	}

	fail = {
		scope:journal_entry = { is_goal_complete = yes }
	}

	on_fail = {
		show_as_tooltip = {
			custom_tooltip = ut_add_new_dawn_progress_neg_5
			ut_add_new_dawn_core_progress = {
				VALUE = -5
			}
			if = {
				limit = {
					scope:target = {
						has_modifier = ut_new_dawn_core_communist_mod
					}
				}
				add_modifier = {
					name = ut_propaganda_communist_mod
					days = short_modifier_time #2.5 years
				}
			}
			else_if = {
				limit = {
					scope:target = {
						has_modifier = ut_new_dawn_core_democratic_mod
					}
				}
				add_modifier = {
					name = ut_propaganda_democratic_mod
					days = short_modifier_time #2.5 years
				}
			}
			else_if = {
				limit = {
					scope:target = {
						has_modifier = ut_new_dawn_core_fascist_mod
					}
				}
				add_modifier = {
					name = ut_propaganda_fascist_mod
					days = short_modifier_time #2.5 years
				}
			}
			else_if = {
				limit = {
					scope:target = {
						has_modifier = ut_new_dawn_core_autocratic_mod
					}
				}
				add_modifier = {
					name = ut_propaganda_autocratic_mod
					days = short_modifier_time #2.5 years
				}
			}
		}
	}

	current_value = {
		value = scope:target.var:ut_propaganda_source_var
	}

	goal_add_value = {
		value = 12 # 1 year
	}

	progressbar = yes

	weight = 10

	should_be_pinned_by_default = yes
}